/*
- Viz: https://docs.google.com/spreadsheets/d/17JJcWTdpJQgTih7iywy3A8Hngs3FFNtv9p5oaJB3BDM/edit#gid=878615601
- k-fold data generation: http://localhost:8888/notebooks/Import%20from%20csv%20to%20DB/training_data_generation.ipynb 
- Function: 
- Table:
- File: 
- Path: E:\SureCash Work\Daily Churn Prediction Nazrul
- Document/Presentation/Dashboard: 
- Email thread: 
- Notes (if any): 
	- fix features: https://docs.google.com/spreadsheets/d/1jcFLdV3N__t8kFGVWc4-hyVQDMLZ35wK07rZlDLlw5Q/edit#gid=1371621641
	- >=75% test accuracy found
	- training takes about 10 mins on 20k data
*/

-- removing nulls and typecasting strings
drop table if exists machine_learning_model.all_feature_for_churn_prediction_2; 
create table machine_learning_model.all_feature_for_churn_prediction_2 as
select 
	mobile_no, 
	
	case when is_app_open_last_saturday is null then 0 else is_app_open_last_saturday end is_app_open_last_saturday,
	case when is_app_open_last_sunday is null then 0 else is_app_open_last_sunday end is_app_open_last_sunday,
	case when is_app_open_last_monday is null then 0 else is_app_open_last_monday end is_app_open_last_monday,
	case when is_app_open_last_tuesday is null then 0 else is_app_open_last_tuesday end is_app_open_last_tuesday,
	case when is_app_open_last_wednesday is null then 0 else is_app_open_last_wednesday end is_app_open_last_wednesday,
	case when is_app_open_last_thursday is null then 0 else is_app_open_last_thursday end is_app_open_last_thursday,
	case when is_app_open_last_friday is null then 0 else is_app_open_last_friday end is_app_open_last_friday,
	case when is_app_open_last_saturday_1 is null then 0 else is_app_open_last_saturday_1 end is_app_open_last_saturday_1,
	case when is_app_open_last_sunday_1 is null then 0 else is_app_open_last_sunday_1 end is_app_open_last_sunday_1,
	case when is_app_open_last_monday_1 is null then 0 else is_app_open_last_monday_1 end is_app_open_last_monday_1,
	case when is_app_open_last_tuesday_1 is null then 0 else is_app_open_last_tuesday_1 end is_app_open_last_tuesday_1,
	case when is_app_open_last_wednesday_1 is null then 0 else is_app_open_last_wednesday_1 end is_app_open_last_wednesday_1,
	case when is_app_open_last_thursday_1 is null then 0 else is_app_open_last_thursday_1 end is_app_open_last_thursday_1,
	case when is_app_open_last_friday_1 is null then 0 else is_app_open_last_friday_1 end is_app_open_last_friday_1,
	case when is_app_open_last_saturday_2 is null then 0 else is_app_open_last_saturday_2 end is_app_open_last_saturday_2,
	case when is_app_open_last_sunday_2 is null then 0 else is_app_open_last_sunday_2 end is_app_open_last_sunday_2,
	case when is_app_open_last_monday_2 is null then 0 else is_app_open_last_monday_2 end is_app_open_last_monday_2,
	case when is_app_open_last_tuesday_2 is null then 0 else is_app_open_last_tuesday_2 end is_app_open_last_tuesday_2,
	case when is_app_open_last_wednesday_2 is null then 0 else is_app_open_last_wednesday_2 end is_app_open_last_wednesday_2,
	case when is_app_open_last_thursday_2 is null then 0 else is_app_open_last_thursday_2 end is_app_open_last_thursday_2,
	case when is_app_open_last_friday_2 is null then 0 else is_app_open_last_friday_2 end is_app_open_last_friday_2,
	case when is_app_open_last_saturday_3 is null then 0 else is_app_open_last_saturday_3 end is_app_open_last_saturday_3,
	case when is_app_open_last_sunday_3 is null then 0 else is_app_open_last_sunday_3 end is_app_open_last_sunday_3,
	case when is_app_open_last_monday_3 is null then 0 else is_app_open_last_monday_3 end is_app_open_last_monday_3,
	case when is_app_open_last_tuesday_3 is null then 0 else is_app_open_last_tuesday_3 end is_app_open_last_tuesday_3,
	case when is_app_open_last_wednesday_3 is null then 0 else is_app_open_last_wednesday_3 end is_app_open_last_wednesday_3,
	case when is_app_open_last_thursday_3 is null then 0 else is_app_open_last_thursday_3 end is_app_open_last_thursday_3,
	case when is_app_open_last_friday_3 is null then 0 else is_app_open_last_friday_3 end is_app_open_last_friday_3,
	case when is_visited_cash_last_saturday is null then 0 else is_visited_cash_last_saturday end is_visited_cash_last_saturday,
	case when is_visited_cash_last_sunday is null then 0 else is_visited_cash_last_sunday end is_visited_cash_last_sunday,
	case when is_visited_cash_last_monday is null then 0 else is_visited_cash_last_monday end is_visited_cash_last_monday,
	case when is_visited_cash_last_tuesday is null then 0 else is_visited_cash_last_tuesday end is_visited_cash_last_tuesday,
	case when is_visited_cash_last_wednesday is null then 0 else is_visited_cash_last_wednesday end is_visited_cash_last_wednesday,
	case when is_visited_cash_last_thursday is null then 0 else is_visited_cash_last_thursday end is_visited_cash_last_thursday,
	case when is_visited_cash_last_friday is null then 0 else is_visited_cash_last_friday end is_visited_cash_last_friday,
	case when is_visited_cash_last_saturday_1 is null then 0 else is_visited_cash_last_saturday_1 end is_visited_cash_last_saturday_1,
	case when is_visited_cash_last_sunday_1 is null then 0 else is_visited_cash_last_sunday_1 end is_visited_cash_last_sunday_1,
	case when is_visited_cash_last_monday_1 is null then 0 else is_visited_cash_last_monday_1 end is_visited_cash_last_monday_1,
	case when is_visited_cash_last_tuesday_1 is null then 0 else is_visited_cash_last_tuesday_1 end is_visited_cash_last_tuesday_1,
	case when is_visited_cash_last_wednesday_1 is null then 0 else is_visited_cash_last_wednesday_1 end is_visited_cash_last_wednesday_1,
	case when is_visited_cash_last_thursday_1 is null then 0 else is_visited_cash_last_thursday_1 end is_visited_cash_last_thursday_1,
	case when is_visited_cash_last_friday_1 is null then 0 else is_visited_cash_last_friday_1 end is_visited_cash_last_friday_1,
	case when is_visited_cash_last_saturday_2 is null then 0 else is_visited_cash_last_saturday_2 end is_visited_cash_last_saturday_2,
	case when is_visited_cash_last_sunday_2 is null then 0 else is_visited_cash_last_sunday_2 end is_visited_cash_last_sunday_2,
	case when is_visited_cash_last_monday_2 is null then 0 else is_visited_cash_last_monday_2 end is_visited_cash_last_monday_2,
	case when is_visited_cash_last_tuesday_2 is null then 0 else is_visited_cash_last_tuesday_2 end is_visited_cash_last_tuesday_2,
	case when is_visited_cash_last_wednesday_2 is null then 0 else is_visited_cash_last_wednesday_2 end is_visited_cash_last_wednesday_2,
	case when is_visited_cash_last_thursday_2 is null then 0 else is_visited_cash_last_thursday_2 end is_visited_cash_last_thursday_2,
	case when is_visited_cash_last_friday_2 is null then 0 else is_visited_cash_last_friday_2 end is_visited_cash_last_friday_2,
	case when is_visited_cash_last_saturday_3 is null then 0 else is_visited_cash_last_saturday_3 end is_visited_cash_last_saturday_3,
	case when is_visited_cash_last_sunday_3 is null then 0 else is_visited_cash_last_sunday_3 end is_visited_cash_last_sunday_3,
	case when is_visited_cash_last_monday_3 is null then 0 else is_visited_cash_last_monday_3 end is_visited_cash_last_monday_3,
	case when is_visited_cash_last_tuesday_3 is null then 0 else is_visited_cash_last_tuesday_3 end is_visited_cash_last_tuesday_3,
	case when is_visited_cash_last_wednesday_3 is null then 0 else is_visited_cash_last_wednesday_3 end is_visited_cash_last_wednesday_3,
	case when is_visited_cash_last_thursday_3 is null then 0 else is_visited_cash_last_thursday_3 end is_visited_cash_last_thursday_3,
	case when is_visited_cash_last_friday_3 is null then 0 else is_visited_cash_last_friday_3 end is_visited_cash_last_friday_3,
	case when is_visited_add_customer_last_saturday is null then 0 else is_visited_add_customer_last_saturday end is_visited_add_customer_last_saturday,
	case when is_visited_add_customer_last_sunday is null then 0 else is_visited_add_customer_last_sunday end is_visited_add_customer_last_sunday,
	case when is_visited_add_customer_last_monday is null then 0 else is_visited_add_customer_last_monday end is_visited_add_customer_last_monday,
	case when is_visited_add_customer_last_tuesday is null then 0 else is_visited_add_customer_last_tuesday end is_visited_add_customer_last_tuesday,
	case when is_visited_add_customer_last_wednesday is null then 0 else is_visited_add_customer_last_wednesday end is_visited_add_customer_last_wednesday,
	case when is_visited_add_customer_last_thursday is null then 0 else is_visited_add_customer_last_thursday end is_visited_add_customer_last_thursday,
	case when is_visited_add_customer_last_friday is null then 0 else is_visited_add_customer_last_friday end is_visited_add_customer_last_friday,
	case when is_visited_add_customer_last_saturday_1 is null then 0 else is_visited_add_customer_last_saturday_1 end is_visited_add_customer_last_saturday_1,
	case when is_visited_add_customer_last_sunday_1 is null then 0 else is_visited_add_customer_last_sunday_1 end is_visited_add_customer_last_sunday_1,
	case when is_visited_add_customer_last_monday_1 is null then 0 else is_visited_add_customer_last_monday_1 end is_visited_add_customer_last_monday_1,
	case when is_visited_add_customer_last_tuesday_1 is null then 0 else is_visited_add_customer_last_tuesday_1 end is_visited_add_customer_last_tuesday_1,
	case when is_visited_add_customer_last_wednesday_1 is null then 0 else is_visited_add_customer_last_wednesday_1 end is_visited_add_customer_last_wednesday_1,
	case when is_visited_add_customer_last_thursday_1 is null then 0 else is_visited_add_customer_last_thursday_1 end is_visited_add_customer_last_thursday_1,
	case when is_visited_add_customer_last_friday_1 is null then 0 else is_visited_add_customer_last_friday_1 end is_visited_add_customer_last_friday_1,
	case when is_visited_add_customer_last_saturday_2 is null then 0 else is_visited_add_customer_last_saturday_2 end is_visited_add_customer_last_saturday_2,
	case when is_visited_add_customer_last_sunday_2 is null then 0 else is_visited_add_customer_last_sunday_2 end is_visited_add_customer_last_sunday_2,
	case when is_visited_add_customer_last_monday_2 is null then 0 else is_visited_add_customer_last_monday_2 end is_visited_add_customer_last_monday_2,
	case when is_visited_add_customer_last_tuesday_2 is null then 0 else is_visited_add_customer_last_tuesday_2 end is_visited_add_customer_last_tuesday_2,
	case when is_visited_add_customer_last_wednesday_2 is null then 0 else is_visited_add_customer_last_wednesday_2 end is_visited_add_customer_last_wednesday_2,
	case when is_visited_add_customer_last_thursday_2 is null then 0 else is_visited_add_customer_last_thursday_2 end is_visited_add_customer_last_thursday_2,
	case when is_visited_add_customer_last_friday_2 is null then 0 else is_visited_add_customer_last_friday_2 end is_visited_add_customer_last_friday_2,
	case when is_visited_add_customer_last_saturday_3 is null then 0 else is_visited_add_customer_last_saturday_3 end is_visited_add_customer_last_saturday_3,
	case when is_visited_add_customer_last_sunday_3 is null then 0 else is_visited_add_customer_last_sunday_3 end is_visited_add_customer_last_sunday_3,
	case when is_visited_add_customer_last_monday_3 is null then 0 else is_visited_add_customer_last_monday_3 end is_visited_add_customer_last_monday_3,
	case when is_visited_add_customer_last_tuesday_3 is null then 0 else is_visited_add_customer_last_tuesday_3 end is_visited_add_customer_last_tuesday_3,
	case when is_visited_add_customer_last_wednesday_3 is null then 0 else is_visited_add_customer_last_wednesday_3 end is_visited_add_customer_last_wednesday_3,
	case when is_visited_add_customer_last_thursday_3 is null then 0 else is_visited_add_customer_last_thursday_3 end is_visited_add_customer_last_thursday_3,
	case when is_visited_add_customer_last_friday_3 is null then 0 else is_visited_add_customer_last_friday_3 end is_visited_add_customer_last_friday_3,
	case when is_visited_refer_button_pressed_last_saturday is null then 0 else is_visited_refer_button_pressed_last_saturday end is_visited_refer_button_pressed_last_saturday,
	case when is_visited_refer_button_pressed_last_sunday is null then 0 else is_visited_refer_button_pressed_last_sunday end is_visited_refer_button_pressed_last_sunday,
	case when is_visited_refer_button_pressed_last_monday is null then 0 else is_visited_refer_button_pressed_last_monday end is_visited_refer_button_pressed_last_monday,
	case when is_visited_refer_button_pressed_last_tuesday is null then 0 else is_visited_refer_button_pressed_last_tuesday end is_visited_refer_button_pressed_last_tuesday,
	case when is_visited_refer_button_pressed_last_wednesday is null then 0 else is_visited_refer_button_pressed_last_wednesday end is_visited_refer_button_pressed_last_wednesday,
	case when is_visited_refer_button_pressed_last_thursday is null then 0 else is_visited_refer_button_pressed_last_thursday end is_visited_refer_button_pressed_last_thursday,
	case when is_visited_refer_button_pressed_last_friday is null then 0 else is_visited_refer_button_pressed_last_friday end is_visited_refer_button_pressed_last_friday,
	case when is_visited_refer_button_pressed_last_saturday_1 is null then 0 else is_visited_refer_button_pressed_last_saturday_1 end is_visited_refer_button_pressed_last_saturday_1,
	case when is_visited_refer_button_pressed_last_sunday_1 is null then 0 else is_visited_refer_button_pressed_last_sunday_1 end is_visited_refer_button_pressed_last_sunday_1,
	case when is_visited_refer_button_pressed_last_monday_1 is null then 0 else is_visited_refer_button_pressed_last_monday_1 end is_visited_refer_button_pressed_last_monday_1,
	case when is_visited_refer_button_pressed_last_tuesday_1 is null then 0 else is_visited_refer_button_pressed_last_tuesday_1 end is_visited_refer_button_pressed_last_tuesday_1,
	case when is_visited_refer_button_pressed_last_wednesday_1 is null then 0 else is_visited_refer_button_pressed_last_wednesday_1 end is_visited_refer_button_pressed_last_wednesday_1,
	case when is_visited_refer_button_pressed_last_thursday_1 is null then 0 else is_visited_refer_button_pressed_last_thursday_1 end is_visited_refer_button_pressed_last_thursday_1,
	case when is_visited_refer_button_pressed_last_friday_1 is null then 0 else is_visited_refer_button_pressed_last_friday_1 end is_visited_refer_button_pressed_last_friday_1,
	case when is_visited_refer_button_pressed_last_saturday_2 is null then 0 else is_visited_refer_button_pressed_last_saturday_2 end is_visited_refer_button_pressed_last_saturday_2,
	case when is_visited_refer_button_pressed_last_sunday_2 is null then 0 else is_visited_refer_button_pressed_last_sunday_2 end is_visited_refer_button_pressed_last_sunday_2,
	case when is_visited_refer_button_pressed_last_monday_2 is null then 0 else is_visited_refer_button_pressed_last_monday_2 end is_visited_refer_button_pressed_last_monday_2,
	case when is_visited_refer_button_pressed_last_tuesday_2 is null then 0 else is_visited_refer_button_pressed_last_tuesday_2 end is_visited_refer_button_pressed_last_tuesday_2,
	case when is_visited_refer_button_pressed_last_wednesday_2 is null then 0 else is_visited_refer_button_pressed_last_wednesday_2 end is_visited_refer_button_pressed_last_wednesday_2,
	case when is_visited_refer_button_pressed_last_thursday_2 is null then 0 else is_visited_refer_button_pressed_last_thursday_2 end is_visited_refer_button_pressed_last_thursday_2,
	case when is_visited_refer_button_pressed_last_friday_2 is null then 0 else is_visited_refer_button_pressed_last_friday_2 end is_visited_refer_button_pressed_last_friday_2,
	case when is_visited_refer_button_pressed_last_saturday_3 is null then 0 else is_visited_refer_button_pressed_last_saturday_3 end is_visited_refer_button_pressed_last_saturday_3,
	case when is_visited_refer_button_pressed_last_sunday_3 is null then 0 else is_visited_refer_button_pressed_last_sunday_3 end is_visited_refer_button_pressed_last_sunday_3,
	case when is_visited_refer_button_pressed_last_monday_3 is null then 0 else is_visited_refer_button_pressed_last_monday_3 end is_visited_refer_button_pressed_last_monday_3,
	case when is_visited_refer_button_pressed_last_tuesday_3 is null then 0 else is_visited_refer_button_pressed_last_tuesday_3 end is_visited_refer_button_pressed_last_tuesday_3,
	case when is_visited_refer_button_pressed_last_wednesday_3 is null then 0 else is_visited_refer_button_pressed_last_wednesday_3 end is_visited_refer_button_pressed_last_wednesday_3,
	case when is_visited_refer_button_pressed_last_thursday_3 is null then 0 else is_visited_refer_button_pressed_last_thursday_3 end is_visited_refer_button_pressed_last_thursday_3,
	case when is_visited_refer_button_pressed_last_friday_3 is null then 0 else is_visited_refer_button_pressed_last_friday_3 end is_visited_refer_button_pressed_last_friday_3,
	case when is_visited_report_download_last_saturday is null then 0 else is_visited_report_download_last_saturday end is_visited_report_download_last_saturday,
	case when is_visited_report_download_last_sunday is null then 0 else is_visited_report_download_last_sunday end is_visited_report_download_last_sunday,
	case when is_visited_report_download_last_monday is null then 0 else is_visited_report_download_last_monday end is_visited_report_download_last_monday,
	case when is_visited_report_download_last_tuesday is null then 0 else is_visited_report_download_last_tuesday end is_visited_report_download_last_tuesday,
	case when is_visited_report_download_last_wednesday is null then 0 else is_visited_report_download_last_wednesday end is_visited_report_download_last_wednesday,
	case when is_visited_report_download_last_thursday is null then 0 else is_visited_report_download_last_thursday end is_visited_report_download_last_thursday,
	case when is_visited_report_download_last_friday is null then 0 else is_visited_report_download_last_friday end is_visited_report_download_last_friday,
	case when is_visited_report_download_last_saturday_1 is null then 0 else is_visited_report_download_last_saturday_1 end is_visited_report_download_last_saturday_1,
	case when is_visited_report_download_last_sunday_1 is null then 0 else is_visited_report_download_last_sunday_1 end is_visited_report_download_last_sunday_1,
	case when is_visited_report_download_last_monday_1 is null then 0 else is_visited_report_download_last_monday_1 end is_visited_report_download_last_monday_1,
	case when is_visited_report_download_last_tuesday_1 is null then 0 else is_visited_report_download_last_tuesday_1 end is_visited_report_download_last_tuesday_1,
	case when is_visited_report_download_last_wednesday_1 is null then 0 else is_visited_report_download_last_wednesday_1 end is_visited_report_download_last_wednesday_1,
	case when is_visited_report_download_last_thursday_1 is null then 0 else is_visited_report_download_last_thursday_1 end is_visited_report_download_last_thursday_1,
	case when is_visited_report_download_last_friday_1 is null then 0 else is_visited_report_download_last_friday_1 end is_visited_report_download_last_friday_1,
	case when is_visited_report_download_last_saturday_2 is null then 0 else is_visited_report_download_last_saturday_2 end is_visited_report_download_last_saturday_2,
	case when is_visited_report_download_last_sunday_2 is null then 0 else is_visited_report_download_last_sunday_2 end is_visited_report_download_last_sunday_2,
	case when is_visited_report_download_last_monday_2 is null then 0 else is_visited_report_download_last_monday_2 end is_visited_report_download_last_monday_2,
	case when is_visited_report_download_last_tuesday_2 is null then 0 else is_visited_report_download_last_tuesday_2 end is_visited_report_download_last_tuesday_2,
	case when is_visited_report_download_last_wednesday_2 is null then 0 else is_visited_report_download_last_wednesday_2 end is_visited_report_download_last_wednesday_2,
	case when is_visited_report_download_last_thursday_2 is null then 0 else is_visited_report_download_last_thursday_2 end is_visited_report_download_last_thursday_2,
	case when is_visited_report_download_last_friday_2 is null then 0 else is_visited_report_download_last_friday_2 end is_visited_report_download_last_friday_2,
	case when is_visited_report_download_last_saturday_3 is null then 0 else is_visited_report_download_last_saturday_3 end is_visited_report_download_last_saturday_3,
	case when is_visited_report_download_last_sunday_3 is null then 0 else is_visited_report_download_last_sunday_3 end is_visited_report_download_last_sunday_3,
	case when is_visited_report_download_last_monday_3 is null then 0 else is_visited_report_download_last_monday_3 end is_visited_report_download_last_monday_3,
	case when is_visited_report_download_last_tuesday_3 is null then 0 else is_visited_report_download_last_tuesday_3 end is_visited_report_download_last_tuesday_3,
	case when is_visited_report_download_last_wednesday_3 is null then 0 else is_visited_report_download_last_wednesday_3 end is_visited_report_download_last_wednesday_3,
	case when is_visited_report_download_last_thursday_3 is null then 0 else is_visited_report_download_last_thursday_3 end is_visited_report_download_last_thursday_3,
	case when is_visited_report_download_last_friday_3 is null then 0 else is_visited_report_download_last_friday_3 end is_visited_report_download_last_friday_3,
	case when is_visited_tagada_message_open_last_saturday is null then 0 else is_visited_tagada_message_open_last_saturday end is_visited_tagada_message_open_last_saturday,
	case when is_visited_tagada_message_open_last_sunday is null then 0 else is_visited_tagada_message_open_last_sunday end is_visited_tagada_message_open_last_sunday,
	case when is_visited_tagada_message_open_last_monday is null then 0 else is_visited_tagada_message_open_last_monday end is_visited_tagada_message_open_last_monday,
	case when is_visited_tagada_message_open_last_tuesday is null then 0 else is_visited_tagada_message_open_last_tuesday end is_visited_tagada_message_open_last_tuesday,
	case when is_visited_tagada_message_open_last_wednesday is null then 0 else is_visited_tagada_message_open_last_wednesday end is_visited_tagada_message_open_last_wednesday,
	case when is_visited_tagada_message_open_last_thursday is null then 0 else is_visited_tagada_message_open_last_thursday end is_visited_tagada_message_open_last_thursday,
	case when is_visited_tagada_message_open_last_friday is null then 0 else is_visited_tagada_message_open_last_friday end is_visited_tagada_message_open_last_friday,
	case when is_visited_tagada_message_open_last_saturday_1 is null then 0 else is_visited_tagada_message_open_last_saturday_1 end is_visited_tagada_message_open_last_saturday_1,
	case when is_visited_tagada_message_open_last_sunday_1 is null then 0 else is_visited_tagada_message_open_last_sunday_1 end is_visited_tagada_message_open_last_sunday_1,
	case when is_visited_tagada_message_open_last_monday_1 is null then 0 else is_visited_tagada_message_open_last_monday_1 end is_visited_tagada_message_open_last_monday_1,
	case when is_visited_tagada_message_open_last_tuesday_1 is null then 0 else is_visited_tagada_message_open_last_tuesday_1 end is_visited_tagada_message_open_last_tuesday_1,
	case when is_visited_tagada_message_open_last_wednesday_1 is null then 0 else is_visited_tagada_message_open_last_wednesday_1 end is_visited_tagada_message_open_last_wednesday_1,
	case when is_visited_tagada_message_open_last_thursday_1 is null then 0 else is_visited_tagada_message_open_last_thursday_1 end is_visited_tagada_message_open_last_thursday_1,
	case when is_visited_tagada_message_open_last_friday_1 is null then 0 else is_visited_tagada_message_open_last_friday_1 end is_visited_tagada_message_open_last_friday_1,
	case when is_visited_tagada_message_open_last_saturday_2 is null then 0 else is_visited_tagada_message_open_last_saturday_2 end is_visited_tagada_message_open_last_saturday_2,
	case when is_visited_tagada_message_open_last_sunday_2 is null then 0 else is_visited_tagada_message_open_last_sunday_2 end is_visited_tagada_message_open_last_sunday_2,
	case when is_visited_tagada_message_open_last_monday_2 is null then 0 else is_visited_tagada_message_open_last_monday_2 end is_visited_tagada_message_open_last_monday_2,
	case when is_visited_tagada_message_open_last_tuesday_2 is null then 0 else is_visited_tagada_message_open_last_tuesday_2 end is_visited_tagada_message_open_last_tuesday_2,
	case when is_visited_tagada_message_open_last_wednesday_2 is null then 0 else is_visited_tagada_message_open_last_wednesday_2 end is_visited_tagada_message_open_last_wednesday_2,
	case when is_visited_tagada_message_open_last_thursday_2 is null then 0 else is_visited_tagada_message_open_last_thursday_2 end is_visited_tagada_message_open_last_thursday_2,
	case when is_visited_tagada_message_open_last_friday_2 is null then 0 else is_visited_tagada_message_open_last_friday_2 end is_visited_tagada_message_open_last_friday_2,
	case when is_visited_tagada_message_open_last_saturday_3 is null then 0 else is_visited_tagada_message_open_last_saturday_3 end is_visited_tagada_message_open_last_saturday_3,
	case when is_visited_tagada_message_open_last_sunday_3 is null then 0 else is_visited_tagada_message_open_last_sunday_3 end is_visited_tagada_message_open_last_sunday_3,
	case when is_visited_tagada_message_open_last_monday_3 is null then 0 else is_visited_tagada_message_open_last_monday_3 end is_visited_tagada_message_open_last_monday_3,
	case when is_visited_tagada_message_open_last_tuesday_3 is null then 0 else is_visited_tagada_message_open_last_tuesday_3 end is_visited_tagada_message_open_last_tuesday_3,
	case when is_visited_tagada_message_open_last_wednesday_3 is null then 0 else is_visited_tagada_message_open_last_wednesday_3 end is_visited_tagada_message_open_last_wednesday_3,
	case when is_visited_tagada_message_open_last_thursday_3 is null then 0 else is_visited_tagada_message_open_last_thursday_3 end is_visited_tagada_message_open_last_thursday_3,
	case when is_visited_tagada_message_open_last_friday_3 is null then 0 else is_visited_tagada_message_open_last_friday_3 end is_visited_tagada_message_open_last_friday_3,
	case when is_visited_inbox_message_open_last_saturday is null then 0 else is_visited_inbox_message_open_last_saturday end is_visited_inbox_message_open_last_saturday,
	case when is_visited_inbox_message_open_last_sunday is null then 0 else is_visited_inbox_message_open_last_sunday end is_visited_inbox_message_open_last_sunday,
	case when is_visited_inbox_message_open_last_monday is null then 0 else is_visited_inbox_message_open_last_monday end is_visited_inbox_message_open_last_monday,
	case when is_visited_inbox_message_open_last_tuesday is null then 0 else is_visited_inbox_message_open_last_tuesday end is_visited_inbox_message_open_last_tuesday,
	case when is_visited_inbox_message_open_last_wednesday is null then 0 else is_visited_inbox_message_open_last_wednesday end is_visited_inbox_message_open_last_wednesday,
	case when is_visited_inbox_message_open_last_thursday is null then 0 else is_visited_inbox_message_open_last_thursday end is_visited_inbox_message_open_last_thursday,
	case when is_visited_inbox_message_open_last_friday is null then 0 else is_visited_inbox_message_open_last_friday end is_visited_inbox_message_open_last_friday,
	case when is_visited_inbox_message_open_last_saturday_1 is null then 0 else is_visited_inbox_message_open_last_saturday_1 end is_visited_inbox_message_open_last_saturday_1,
	case when is_visited_inbox_message_open_last_sunday_1 is null then 0 else is_visited_inbox_message_open_last_sunday_1 end is_visited_inbox_message_open_last_sunday_1,
	case when is_visited_inbox_message_open_last_monday_1 is null then 0 else is_visited_inbox_message_open_last_monday_1 end is_visited_inbox_message_open_last_monday_1,
	case when is_visited_inbox_message_open_last_tuesday_1 is null then 0 else is_visited_inbox_message_open_last_tuesday_1 end is_visited_inbox_message_open_last_tuesday_1,
	case when is_visited_inbox_message_open_last_wednesday_1 is null then 0 else is_visited_inbox_message_open_last_wednesday_1 end is_visited_inbox_message_open_last_wednesday_1,
	case when is_visited_inbox_message_open_last_thursday_1 is null then 0 else is_visited_inbox_message_open_last_thursday_1 end is_visited_inbox_message_open_last_thursday_1,
	case when is_visited_inbox_message_open_last_friday_1 is null then 0 else is_visited_inbox_message_open_last_friday_1 end is_visited_inbox_message_open_last_friday_1,
	case when is_visited_inbox_message_open_last_saturday_2 is null then 0 else is_visited_inbox_message_open_last_saturday_2 end is_visited_inbox_message_open_last_saturday_2,
	case when is_visited_inbox_message_open_last_sunday_2 is null then 0 else is_visited_inbox_message_open_last_sunday_2 end is_visited_inbox_message_open_last_sunday_2,
	case when is_visited_inbox_message_open_last_monday_2 is null then 0 else is_visited_inbox_message_open_last_monday_2 end is_visited_inbox_message_open_last_monday_2,
	case when is_visited_inbox_message_open_last_tuesday_2 is null then 0 else is_visited_inbox_message_open_last_tuesday_2 end is_visited_inbox_message_open_last_tuesday_2,
	case when is_visited_inbox_message_open_last_wednesday_2 is null then 0 else is_visited_inbox_message_open_last_wednesday_2 end is_visited_inbox_message_open_last_wednesday_2,
	case when is_visited_inbox_message_open_last_thursday_2 is null then 0 else is_visited_inbox_message_open_last_thursday_2 end is_visited_inbox_message_open_last_thursday_2,
	case when is_visited_inbox_message_open_last_friday_2 is null then 0 else is_visited_inbox_message_open_last_friday_2 end is_visited_inbox_message_open_last_friday_2,
	case when is_visited_inbox_message_open_last_saturday_3 is null then 0 else is_visited_inbox_message_open_last_saturday_3 end is_visited_inbox_message_open_last_saturday_3,
	case when is_visited_inbox_message_open_last_sunday_3 is null then 0 else is_visited_inbox_message_open_last_sunday_3 end is_visited_inbox_message_open_last_sunday_3,
	case when is_visited_inbox_message_open_last_monday_3 is null then 0 else is_visited_inbox_message_open_last_monday_3 end is_visited_inbox_message_open_last_monday_3,
	case when is_visited_inbox_message_open_last_tuesday_3 is null then 0 else is_visited_inbox_message_open_last_tuesday_3 end is_visited_inbox_message_open_last_tuesday_3,
	case when is_visited_inbox_message_open_last_wednesday_3 is null then 0 else is_visited_inbox_message_open_last_wednesday_3 end is_visited_inbox_message_open_last_wednesday_3,
	case when is_visited_inbox_message_open_last_thursday_3 is null then 0 else is_visited_inbox_message_open_last_thursday_3 end is_visited_inbox_message_open_last_thursday_3,
	case when is_visited_inbox_message_open_last_friday_3 is null then 0 else is_visited_inbox_message_open_last_friday_3 end is_visited_inbox_message_open_last_friday_3,
	case when pct_of_saturday_active_in_4_weeks is null then 0 else pct_of_saturday_active_in_4_weeks end pct_of_saturday_active_in_4_weeks,
	case when pct_of_sunday_active_in_4_weeks is null then 0 else pct_of_sunday_active_in_4_weeks end pct_of_sunday_active_in_4_weeks,
	case when pct_of_monday_active_in_4_weeks is null then 0 else pct_of_monday_active_in_4_weeks end pct_of_monday_active_in_4_weeks,
	case when pct_of_tuesday_active_in_4_weeks is null then 0 else pct_of_tuesday_active_in_4_weeks end pct_of_tuesday_active_in_4_weeks,
	case when pct_of_wednesday_active_in_4_weeks is null then 0 else pct_of_wednesday_active_in_4_weeks end pct_of_wednesday_active_in_4_weeks,
	case when pct_of_thursday_active_in_4_weeks is null then 0 else pct_of_thursday_active_in_4_weeks end pct_of_thursday_active_in_4_weeks,
	case when pct_of_friday_active_in_4_weeks is null then 0 else pct_of_friday_active_in_4_weeks end pct_of_friday_active_in_4_weeks,
	case when pct_of_saturday_active_in_lifetime is null then 0 else pct_of_saturday_active_in_lifetime end pct_of_saturday_active_in_lifetime,
	case when pct_of_sunday_active_in_lifetime is null then 0 else pct_of_sunday_active_in_lifetime end pct_of_sunday_active_in_lifetime,
	case when pct_of_monday_active_in_lifetime is null then 0 else pct_of_monday_active_in_lifetime end pct_of_monday_active_in_lifetime,
	case when pct_of_tuesday_active_in_lifetime is null then 0 else pct_of_tuesday_active_in_lifetime end pct_of_tuesday_active_in_lifetime,
	case when pct_of_wednesday_active_in_lifetime is null then 0 else pct_of_wednesday_active_in_lifetime end pct_of_wednesday_active_in_lifetime,
	case when pct_of_thursday_active_in_lifetime is null then 0 else pct_of_thursday_active_in_lifetime end pct_of_thursday_active_in_lifetime,
	case when pct_of_friday_active_in_lifetime is null then 0 else pct_of_friday_active_in_lifetime end pct_of_friday_active_in_lifetime,
	case when number_of_active_days_last_week is null then 0 else number_of_active_days_last_week end number_of_active_days_last_week,
	case when number_of_active_days_last_week_1 is null then 0 else number_of_active_days_last_week_1 end number_of_active_days_last_week_1,
	case when number_of_active_days_last_week_2 is null then 0 else number_of_active_days_last_week_2 end number_of_active_days_last_week_2,
	case when number_of_active_days_last_week_3 is null then 0 else number_of_active_days_last_week_3 end number_of_active_days_last_week_3,
	case when pct_of_active_days_last_week is null then 0 else pct_of_active_days_last_week end pct_of_active_days_last_week,
	case when pct_of_active_days_last_week_1 is null then 0 else pct_of_active_days_last_week_1 end pct_of_active_days_last_week_1,
	case when pct_of_active_days_last_week_2 is null then 0 else pct_of_active_days_last_week_2 end pct_of_active_days_last_week_2,
	case when pct_of_active_days_last_week_3 is null then 0 else pct_of_active_days_last_week_3 end pct_of_active_days_last_week_3,
	case when pct_of_active_days_last_month is null then 0 else pct_of_active_days_last_month end pct_of_active_days_last_month,
	case when trt_saturday_last_week is null then 0 else trt_saturday_last_week end trt_saturday_last_week,
	case when trt_sunday_last_week is null then 0 else trt_sunday_last_week end trt_sunday_last_week,
	case when trt_monday_last_week is null then 0 else trt_monday_last_week end trt_monday_last_week,
	case when trt_tuesday_last_week is null then 0 else trt_tuesday_last_week end trt_tuesday_last_week,
	case when trt_wednesday_last_week is null then 0 else trt_wednesday_last_week end trt_wednesday_last_week,
	case when trt_thursday_last_week is null then 0 else trt_thursday_last_week end trt_thursday_last_week,
	case when trt_friday_last_week is null then 0 else trt_friday_last_week end trt_friday_last_week,
	case when trt_saturday_last_week_1 is null then 0 else trt_saturday_last_week_1 end trt_saturday_last_week_1,
	case when trt_sunday_last_week_1 is null then 0 else trt_sunday_last_week_1 end trt_sunday_last_week_1,
	case when trt_monday_last_week_1 is null then 0 else trt_monday_last_week_1 end trt_monday_last_week_1,
	case when trt_tuesday_last_week_1 is null then 0 else trt_tuesday_last_week_1 end trt_tuesday_last_week_1,
	case when trt_wednesday_last_week_1 is null then 0 else trt_wednesday_last_week_1 end trt_wednesday_last_week_1,
	case when trt_thursday_last_week_1 is null then 0 else trt_thursday_last_week_1 end trt_thursday_last_week_1,
	case when trt_friday_last_week_1 is null then 0 else trt_friday_last_week_1 end trt_friday_last_week_1,
	case when trt_saturday_last_week_2 is null then 0 else trt_saturday_last_week_2 end trt_saturday_last_week_2,
	case when trt_sunday_last_week_2 is null then 0 else trt_sunday_last_week_2 end trt_sunday_last_week_2,
	case when trt_monday_last_week_2 is null then 0 else trt_monday_last_week_2 end trt_monday_last_week_2,
	case when trt_tuesday_last_week_2 is null then 0 else trt_tuesday_last_week_2 end trt_tuesday_last_week_2,
	case when trt_wednesday_last_week_2 is null then 0 else trt_wednesday_last_week_2 end trt_wednesday_last_week_2,
	case when trt_thursday_last_week_2 is null then 0 else trt_thursday_last_week_2 end trt_thursday_last_week_2,
	case when trt_friday_last_week_2 is null then 0 else trt_friday_last_week_2 end trt_friday_last_week_2,
	case when trt_saturday_last_week_3 is null then 0 else trt_saturday_last_week_3 end trt_saturday_last_week_3,
	case when trt_sunday_last_week_3 is null then 0 else trt_sunday_last_week_3 end trt_sunday_last_week_3,
	case when trt_monday_last_week_3 is null then 0 else trt_monday_last_week_3 end trt_monday_last_week_3,
	case when trt_tuesday_last_week_3 is null then 0 else trt_tuesday_last_week_3 end trt_tuesday_last_week_3,
	case when trt_wednesday_last_week_3 is null then 0 else trt_wednesday_last_week_3 end trt_wednesday_last_week_3,
	case when trt_thursday_last_week_3 is null then 0 else trt_thursday_last_week_3 end trt_thursday_last_week_3,
	case when trt_friday_last_week_3 is null then 0 else trt_friday_last_week_3 end trt_friday_last_week_3,
	case when trv_saturday_last_week is null then 0 else trv_saturday_last_week end trv_saturday_last_week,
	case when trv_sunday_last_week is null then 0 else trv_sunday_last_week end trv_sunday_last_week,
	case when trv_monday_last_week is null then 0 else trv_monday_last_week end trv_monday_last_week,
	case when trv_tuesday_last_week is null then 0 else trv_tuesday_last_week end trv_tuesday_last_week,
	case when trv_wednesday_last_week is null then 0 else trv_wednesday_last_week end trv_wednesday_last_week,
	case when trv_thursday_last_week is null then 0 else trv_thursday_last_week end trv_thursday_last_week,
	case when trv_friday_last_week is null then 0 else trv_friday_last_week end trv_friday_last_week,
	case when trv_saturday_last_week_1 is null then 0 else trv_saturday_last_week_1 end trv_saturday_last_week_1,
	case when trv_sunday_last_week_1 is null then 0 else trv_sunday_last_week_1 end trv_sunday_last_week_1,
	case when trv_monday_last_week_1 is null then 0 else trv_monday_last_week_1 end trv_monday_last_week_1,
	case when trv_tuesday_last_week_1 is null then 0 else trv_tuesday_last_week_1 end trv_tuesday_last_week_1,
	case when trv_wednesday_last_week_1 is null then 0 else trv_wednesday_last_week_1 end trv_wednesday_last_week_1,
	case when trv_thursday_last_week_1 is null then 0 else trv_thursday_last_week_1 end trv_thursday_last_week_1,
	case when trv_friday_last_week_1 is null then 0 else trv_friday_last_week_1 end trv_friday_last_week_1,
	case when trv_saturday_last_week_2 is null then 0 else trv_saturday_last_week_2 end trv_saturday_last_week_2,
	case when trv_sunday_last_week_2 is null then 0 else trv_sunday_last_week_2 end trv_sunday_last_week_2,
	case when trv_monday_last_week_2 is null then 0 else trv_monday_last_week_2 end trv_monday_last_week_2,
	case when trv_tuesday_last_week_2 is null then 0 else trv_tuesday_last_week_2 end trv_tuesday_last_week_2,
	case when trv_wednesday_last_week_2 is null then 0 else trv_wednesday_last_week_2 end trv_wednesday_last_week_2,
	case when trv_thursday_last_week_2 is null then 0 else trv_thursday_last_week_2 end trv_thursday_last_week_2,
	case when trv_friday_last_week_2 is null then 0 else trv_friday_last_week_2 end trv_friday_last_week_2,
	case when trv_saturday_last_week_3 is null then 0 else trv_saturday_last_week_3 end trv_saturday_last_week_3,
	case when trv_sunday_last_week_3 is null then 0 else trv_sunday_last_week_3 end trv_sunday_last_week_3,
	case when trv_monday_last_week_3 is null then 0 else trv_monday_last_week_3 end trv_monday_last_week_3,
	case when trv_tuesday_last_week_3 is null then 0 else trv_tuesday_last_week_3 end trv_tuesday_last_week_3,
	case when trv_wednesday_last_week_3 is null then 0 else trv_wednesday_last_week_3 end trv_wednesday_last_week_3,
	case when trv_thursday_last_week_3 is null then 0 else trv_thursday_last_week_3 end trv_thursday_last_week_3,
	case when trv_friday_last_week_3 is null then 0 else trv_friday_last_week_3 end trv_friday_last_week_3,
	case when tacs_saturday_last_week is null then 0 else tacs_saturday_last_week end tacs_saturday_last_week,
	case when tacs_sunday_last_week is null then 0 else tacs_sunday_last_week end tacs_sunday_last_week,
	case when tacs_monday_last_week is null then 0 else tacs_monday_last_week end tacs_monday_last_week,
	case when tacs_tuesday_last_week is null then 0 else tacs_tuesday_last_week end tacs_tuesday_last_week,
	case when tacs_wednesday_last_week is null then 0 else tacs_wednesday_last_week end tacs_wednesday_last_week,
	case when tacs_thursday_last_week is null then 0 else tacs_thursday_last_week end tacs_thursday_last_week,
	case when tacs_friday_last_week is null then 0 else tacs_friday_last_week end tacs_friday_last_week,
	case when tacs_saturday_last_week_1 is null then 0 else tacs_saturday_last_week_1 end tacs_saturday_last_week_1,
	case when tacs_sunday_last_week_1 is null then 0 else tacs_sunday_last_week_1 end tacs_sunday_last_week_1,
	case when tacs_monday_last_week_1 is null then 0 else tacs_monday_last_week_1 end tacs_monday_last_week_1,
	case when tacs_tuesday_last_week_1 is null then 0 else tacs_tuesday_last_week_1 end tacs_tuesday_last_week_1,
	case when tacs_wednesday_last_week_1 is null then 0 else tacs_wednesday_last_week_1 end tacs_wednesday_last_week_1,
	case when tacs_thursday_last_week_1 is null then 0 else tacs_thursday_last_week_1 end tacs_thursday_last_week_1,
	case when tacs_friday_last_week_1 is null then 0 else tacs_friday_last_week_1 end tacs_friday_last_week_1,
	case when tacs_saturday_last_week_2 is null then 0 else tacs_saturday_last_week_2 end tacs_saturday_last_week_2,
	case when tacs_sunday_last_week_2 is null then 0 else tacs_sunday_last_week_2 end tacs_sunday_last_week_2,
	case when tacs_monday_last_week_2 is null then 0 else tacs_monday_last_week_2 end tacs_monday_last_week_2,
	case when tacs_tuesday_last_week_2 is null then 0 else tacs_tuesday_last_week_2 end tacs_tuesday_last_week_2,
	case when tacs_wednesday_last_week_2 is null then 0 else tacs_wednesday_last_week_2 end tacs_wednesday_last_week_2,
	case when tacs_thursday_last_week_2 is null then 0 else tacs_thursday_last_week_2 end tacs_thursday_last_week_2,
	case when tacs_friday_last_week_2 is null then 0 else tacs_friday_last_week_2 end tacs_friday_last_week_2,
	case when tacs_saturday_last_week_3 is null then 0 else tacs_saturday_last_week_3 end tacs_saturday_last_week_3,
	case when tacs_sunday_last_week_3 is null then 0 else tacs_sunday_last_week_3 end tacs_sunday_last_week_3,
	case when tacs_monday_last_week_3 is null then 0 else tacs_monday_last_week_3 end tacs_monday_last_week_3,
	case when tacs_tuesday_last_week_3 is null then 0 else tacs_tuesday_last_week_3 end tacs_tuesday_last_week_3,
	case when tacs_wednesday_last_week_3 is null then 0 else tacs_wednesday_last_week_3 end tacs_wednesday_last_week_3,
	case when tacs_thursday_last_week_3 is null then 0 else tacs_thursday_last_week_3 end tacs_thursday_last_week_3,
	case when tacs_friday_last_week_3 is null then 0 else tacs_friday_last_week_3 end tacs_friday_last_week_3,
	case when number_of_tacs_added_last_week is null then 0 else number_of_tacs_added_last_week end number_of_tacs_added_last_week,
	case when number_of_tacs_added_last_week_1 is null then 0 else number_of_tacs_added_last_week_1 end number_of_tacs_added_last_week_1,
	case when number_of_tacs_added_last_week_2 is null then 0 else number_of_tacs_added_last_week_2 end number_of_tacs_added_last_week_2,
	case when number_of_tacs_added_last_week_3 is null then 0 else number_of_tacs_added_last_week_3 end number_of_tacs_added_last_week_3,
	case when number_of_trt_added_last_week is null then 0 else number_of_trt_added_last_week end number_of_trt_added_last_week,
	case when number_of_trt_added_last_week_1 is null then 0 else number_of_trt_added_last_week_1 end number_of_trt_added_last_week_1,
	case when number_of_trt_added_last_week_2 is null then 0 else number_of_trt_added_last_week_2 end number_of_trt_added_last_week_2,
	case when number_of_trt_added_last_week_3 is null then 0 else number_of_trt_added_last_week_3 end number_of_trt_added_last_week_3,
	case when number_of_trv_added_last_week is null then 0 else number_of_trv_added_last_week end number_of_trv_added_last_week,
	case when number_of_trv_added_last_week_1 is null then 0 else number_of_trv_added_last_week_1 end number_of_trv_added_last_week_1,
	case when number_of_trv_added_last_week_2 is null then 0 else number_of_trv_added_last_week_2 end number_of_trv_added_last_week_2,
	case when number_of_trv_added_last_week_3 is null then 0 else number_of_trv_added_last_week_3 end number_of_trv_added_last_week_3,
	case when number_of_trt_last_month is null then 0 else number_of_trt_last_month end number_of_trt_last_month,
	case when amount_of_trv_last_month is null then 0 else amount_of_trv_last_month end amount_of_trv_last_month,
	case when number_of_tacs_last_month is null then 0 else number_of_tacs_last_month end number_of_tacs_last_month,
	case when number_of_active_days_last_month is null then 0 else number_of_active_days_last_month end number_of_active_days_last_month,
	case when number_of_trt_last_month_1 is null then 0 else number_of_trt_last_month_1 end number_of_trt_last_month_1,
	case when amount_of_trv_last_month_1 is null then 0 else amount_of_trv_last_month_1 end amount_of_trv_last_month_1,
	case when number_of_tacs_last_month_1 is null then 0 else number_of_tacs_last_month_1 end number_of_tacs_last_month_1,
	case when number_of_active_days_last_month_1 is null then 0 else number_of_active_days_last_month_1 end number_of_active_days_last_month_1,
	case when number_of_trt_last_15_days is null then 0 else number_of_trt_last_15_days end number_of_trt_last_15_days,
	case when amount_of_trv_last_15_days is null then 0 else amount_of_trv_last_15_days end amount_of_trv_last_15_days,
	case when number_of_tacs_last_15_days is null then 0 else number_of_tacs_last_15_days end number_of_tacs_last_15_days,
	case when number_of_active_days_last_15_days is null then 0 else number_of_active_days_last_15_days end number_of_active_days_last_15_days,
	case when number_of_trt_last_15_days_1 is null then 0 else number_of_trt_last_15_days_1 end number_of_trt_last_15_days_1,
	case when amount_of_trv_last_15_days_1 is null then 0 else amount_of_trv_last_15_days_1 end amount_of_trv_last_15_days_1,
	case when number_of_tacs_last_15_days_1 is null then 0 else number_of_tacs_last_15_days_1 end number_of_tacs_last_15_days_1,
	case when number_of_active_days_last_15_days_1 is null then 0 else number_of_active_days_last_15_days_1 end number_of_active_days_last_15_days_1,
	case when number_of_cash_recorded_last_month is null then 0 else number_of_cash_recorded_last_month end number_of_cash_recorded_last_month,
	case when number_of_cash_recorded_last_month_1 is null then 0 else number_of_cash_recorded_last_month_1 end number_of_cash_recorded_last_month_1,
	case when number_of_cash_recorded_last_15_days is null then 0 else number_of_cash_recorded_last_15_days end number_of_cash_recorded_last_15_days,
	case when number_of_cash_recorded_last_15_days_1 is null then 0 else number_of_cash_recorded_last_15_days_1 end number_of_cash_recorded_last_15_days_1,
	case when number_of_days_cash_recorded_last_month is null then 0 else number_of_days_cash_recorded_last_month end number_of_days_cash_recorded_last_month,
	case when number_of_days_credit_recorded_last_month is null then 0 else number_of_days_credit_recorded_last_month end number_of_days_credit_recorded_last_month,
	
	case when last_four_weeks_momt_trt_day::int is null then 0 else last_four_weeks_momt_trt_day::int end last_four_weeks_momt_trt_day, 
	case when last_four_weeks_momt_trv_day::int is null then 0 else last_four_weeks_momt_trv_day::int end last_four_weeks_momt_trv_day, 
	case when last_four_weeks_momt_tacs_day::int is null then 0 else last_four_weeks_momt_tacs_day::int end last_four_weeks_momt_tacs_day, 
	case when app_opened_last_week::int is null then 0 else app_opened_last_week::int end app_opened_last_week, 
	case when app_opened_last_week_1::int is null then 0 else app_opened_last_week_1::int end app_opened_last_week_1, 
	case when app_opened_last_week_2::int is null then 0 else app_opened_last_week_2::int end app_opened_last_week_2, 
	case when app_opened_last_week_3::int is null then 0 else app_opened_last_week_3::int end app_opened_last_week_3, 
	case when time_spent_saturday_last_week::int is null then 0 else time_spent_saturday_last_week::int end time_spent_saturday_last_week, 
	case when time_spent_sunday_last_week::int is null then 0 else time_spent_sunday_last_week::int end time_spent_sunday_last_week, 
	case when time_spent_monday_last_week::int is null then 0 else time_spent_monday_last_week::int end time_spent_monday_last_week, 
	case when time_spent_tuesday_last_week::int is null then 0 else time_spent_tuesday_last_week::int end time_spent_tuesday_last_week, 
	case when time_spent_wednesday_last_week::int is null then 0 else time_spent_wednesday_last_week::int end time_spent_wednesday_last_week, 
	case when time_spent_thursday_last_week::int is null then 0 else time_spent_thursday_last_week::int end time_spent_thursday_last_week, 
	case when time_spent_friday_last_week::int is null then 0 else time_spent_friday_last_week::int end time_spent_friday_last_week, 
	case when time_spent_saturday_last_week_1::int is null then 0 else time_spent_saturday_last_week_1::int end time_spent_saturday_last_week_1, 
	case when time_spent_sunday_last_week_1::int is null then 0 else time_spent_sunday_last_week_1::int end time_spent_sunday_last_week_1, 
	case when time_spent_monday_last_week_1::int is null then 0 else time_spent_monday_last_week_1::int end time_spent_monday_last_week_1, 
	case when time_spent_tuesday_last_week_1::int is null then 0 else time_spent_tuesday_last_week_1::int end time_spent_tuesday_last_week_1, 
	case when time_spent_wednesday_last_week_1::int is null then 0 else time_spent_wednesday_last_week_1::int end time_spent_wednesday_last_week_1, 
	case when time_spent_thursday_last_week_1::int is null then 0 else time_spent_thursday_last_week_1::int end time_spent_thursday_last_week_1, 
	case when time_spent_friday_last_week_1::int is null then 0 else time_spent_friday_last_week_1::int end time_spent_friday_last_week_1, 
	case when time_spent_saturday_last_week_2::int is null then 0 else time_spent_saturday_last_week_2::int end time_spent_saturday_last_week_2, 
	case when time_spent_sunday_last_week_2::int is null then 0 else time_spent_sunday_last_week_2::int end time_spent_sunday_last_week_2, 
	case when time_spent_monday_last_week_2::int is null then 0 else time_spent_monday_last_week_2::int end time_spent_monday_last_week_2, 
	case when time_spent_tuesday_last_week_2::int is null then 0 else time_spent_tuesday_last_week_2::int end time_spent_tuesday_last_week_2, 
	case when time_spent_wednesday_last_week_2::int is null then 0 else time_spent_wednesday_last_week_2::int end time_spent_wednesday_last_week_2, 
	case when time_spent_thursday_last_week_2::int is null then 0 else time_spent_thursday_last_week_2::int end time_spent_thursday_last_week_2, 
	case when time_spent_friday_last_week_2::int is null then 0 else time_spent_friday_last_week_2::int end time_spent_friday_last_week_2, 
	case when time_spent_saturday_last_week_3::int is null then 0 else time_spent_saturday_last_week_3::int end time_spent_saturday_last_week_3, 
	case when time_spent_sunday_last_week_3::int is null then 0 else time_spent_sunday_last_week_3::int end time_spent_sunday_last_week_3, 
	case when time_spent_monday_last_week_3::int is null then 0 else time_spent_monday_last_week_3::int end time_spent_monday_last_week_3, 
	case when time_spent_tuesday_last_week_3::int is null then 0 else time_spent_tuesday_last_week_3::int end time_spent_tuesday_last_week_3, 
	case when time_spent_wednesday_last_week_3::int is null then 0 else time_spent_wednesday_last_week_3::int end time_spent_wednesday_last_week_3, 
	case when time_spent_thursday_last_week_3::int is null then 0 else time_spent_thursday_last_week_3::int end time_spent_thursday_last_week_3, 
	case when time_spent_friday_last_week_3::int is null then 0 else time_spent_friday_last_week_3::int end time_spent_friday_last_week_3, 
	case when time_spent_last_week::int is null then 0 else time_spent_last_week::int end time_spent_last_week, 
	case when time_spent_last_week_1::int is null then 0 else time_spent_last_week_1::int end time_spent_last_week_1, 
	case when time_spent_last_week_2::int is null then 0 else time_spent_last_week_2::int end time_spent_last_week_2, 
	case when time_spent_last_week_3::int is null then 0 else time_spent_last_week_3::int end time_spent_last_week_3, 
	case when new_bi_business_type::int is null then 0 else new_bi_business_type::int end new_bi_business_type, 
	case when device_brand::int is null then 0 else device_brand::int end device_brand, 
	case when business_address::int is null then 0 else business_address::int end business_address, 
	case when trade_licence_no::int is null then 0 else trade_licence_no::int end trade_licence_no, 
	case when owner_nid::int is null then 0 else owner_nid::int end owner_nid, 
	case when business_age::int is null then 0 else business_age::int end business_age, 
	case when area_type::int is null then 0 else area_type::int end area_type, 
	case when today_day_no_of_the_week::int is null then 0 else today_day_no_of_the_week::int end today_day_no_of_the_week, 
	case when is_location_available::int is null then 0 else is_location_available::int end is_location_available, 
	case when days_with_tallykhata::int is null then 0 else days_with_tallykhata::int end days_with_tallykhata, 
	case when registration_week::int is null then 0 else registration_week::int end registration_week, 
	case when registration_month::int is null then 0 else registration_month::int end registration_month, 
	case when reg_app_version::int is null then 0 else reg_app_version::int end reg_app_version, 
	case when current_app_version::int is null then 0 else current_app_version::int end current_app_version

from machine_learning_model.all_feature_for_churn_prediction; -- main dataset generated

-- see distribution of training data
select if_churn, count(mobile_no) merchants 
from 
	(-- generate training data
	select 
		tbl1.*, -- identifiers, features
		case when tbl2.mobile_no is not null then 0 else 1 end if_churn -- labels
	from
		machine_learning_model.all_feature_for_churn_prediction_2 tbl1 
		
		left join 
		
		(select mobile_no
		from tallykhata.tallykhata_user_date_sequence_final 
		where event_date='2021-09-01'
		) tbl2 using(mobile_no)
	order by random()
	limit 20000 -- sample size
	) tbl1 
group by 1; 
